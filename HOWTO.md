Последовательность действий на HighLoad Cup 2017
================================================

> Чтобы приступить к выполенению [задания](https://github.com/sat2707/hlcupdocs/blob/master/TASK.md), вам необходимо скачать архив с тестовыми [данными](https://github.com/sat2707/hlcupdocs/tree/master/data/TRAIN) в формате JSON (данные вы также можете скачать с сайта проведения конкурса [https://highloadcup.ru](https://highloadcup.ru)). 

> Вам необходимо сначала создать, а затем и развернуть производительный сервер приложения, который будет реализовывать необходимое Web API к этим данным.

> Мы рекомендуем сначала отладить своё решение локально на тестовых данных. Когда вы будете готовы, соберите из него docker-контейнер и залейте его в хранилище системы проведения конкурса. Специально для вас мы выложили [пример](https://github.com/sat2707/hlcupdocs/blob/master/EXAMPLE.md#Сборка-и-запуск-docker-контейнера) данной процедуры. После этого на странице с задачей на сайте HighLoad Cup появится запись о принятом решении и о постановке его в очередь на предварительный обстрел. 

> __Будет происходить следующее__:

Шаг 1. 
------
> Решение будет отправлено на тестирующую машину с процессором `Intel Xeon (4 ядра по 2 GHz)` и `RAM 4GB`. Доступная память = `10 GB HDD`. 

Шаг 2. 
------
> Решение будет поднято как docker-контейнер (`docker run`). Если при запуске появятся ошибки, то они будут показаны на странице с логами обстрела.

Шаг 3. 
------
> После запуска контейнера в папке `/tmp/data` будет доступен файл `data.zip` с архивироваными "боевыми" данными (примерно 200 килобайт для предварительного и 20 мегабайт для полного обстрела) и `options.txt`. В архиве будут лежать файлы с названиями вида "<имя сущности>_<номер файла>.json". Например:
```
        ├── users_1.json
        ├── users_2.json
        ├── locations_1.json
        ├── locations_2.json
        ├── visits_1.json
        ├── visits_2.json
        └── visits_3.json
```

> Внутри таких файлов - данные в формате JSON. К примеру, данные о путешественниках будут иметь такую структуру:  

```json
    {
        "users": [
            {
                "id": 1,
                "email": "robosen@icloud.com",
                "first_name": "Данила",
                "last_name": "Стамленский",
                "gender": "m",
                "birth_date": 345081600
            }, {
                "id": 2,
                "email": "tameerne@yandex.ru",
                "first_name": "Аня",
                "last_name": "Шишкина",
                "gender": "f",
                "birth_date": -1571356800
            }
        ]
    }
 ```
> Для посещений и достопримечательностей - аналогично.

> Внутри файла `options.txt` будут две строчки.
```
        1502881955     # timestamp время генерации данных
        0              # Значение 0 - тестовый обстрел, значение 1 - рейтинговый обстрел.
```
> Таким образом, можно определить, данные тестовые или рейтинговые.

Шаг 4.
------
> У сервера есть фиксированное время до начала обстрела, чтобы залить эти данные в собственную базу данных и подготовить их к обработке (`30 секунд` для предварительного и `3 минуты` для полного обстрела). [Подробнее](https://github.com/sat2707/hlcupdocs/blob/master/FAQ.md#Какие-виды-обстрела-существуют)

Шаг 5.
------
> По истечении времени __Шага 4__ начинается обстрел сервера запросами из списка [API](https://github.com/sat2707/hlcupdocs/blob/master/TASK.md#Описание-api), который длится `70 секунд` для предварительного и `7 минут` для рейтингового. __Важно - сервер должен слушать `80-й порт`__, чтобы обстрел прошел успешно! Запросы идут с заголовком `Host: travels.com` по протоколу `HTTP/1.1`, один запрос - одно соединение. __Сетевые потери полностью отсутствуют__.

Шаг 6.
------
> Результаты и логи обстрела вы увидите на сайте, на странице с деталями решения в секциях "Обстрел" и "Результаты" соответственно.

> __При замеченных попытках хакерских атак на сервера проведения конкурса Highload Cup 2017 участнику выдаётся бан, а результаты обстрела не засчитываются.__

> __Обратите внимание!__ Предварительный обстрел запускается автоматически и нужен для тестирования решения на малой нагрузке. По такому обстрелу показываются результаты в виде графиков, но __не считается рейтинг__. Для участия в рейтинге, необходимо вручную запустить рейтинговый обстрел, который проводится в гораздо более хардкорных условиях. 
[Подробнее](https://github.com/sat2707/hlcupdocs/blob/master/FAQ.md#Как-рассчитывается-рейтинг)

> Результаты рейтинговых обстрелов всех участников будут сводиться в таблицу на сайте. [Подробнее](https://github.com/sat2707/hlcupdocs/blob/master/FAQ.md#Как-рассчитывается-рейтинг)

Лучшие из лучших получат призы! [Подробнее](https://github.com/sat2707/hlcupdocs/blob/master/FAQ.md#Какие-призы-получат-победители-highload-cup-2017)
